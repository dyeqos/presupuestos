"use strict";(self.webpackChunkpresupuestoFrontend=self.webpackChunkpresupuestoFrontend||[]).push([[941],{5941:(H,U,a)=>{a.r(U),a.d(U,{UsuariosModule:()=>j});var p=a(9808),i=a(3075),g=a(1083),c=a(2349),t=a(5e3),d=a(520),C=a(2340),T=a(6518);let b=(()=>{class r{constructor(o,s){this.http=o,this.authService=s,this.baseUrl=C.N.baseUrl}getUsuarios(o=""){return this.http.get(`${this.baseUrl}/usuarios/${o}`)}postUsuario(o){const s=`${this.baseUrl}/usuarios/`,n=(new d.WM).set("x-token",this.authService.token);return this.http.post(s,o,{headers:n})}putUsuario(o){const s=`${this.baseUrl}/usuarios/`,n=(new d.WM).set("x-token",this.authService.token);return this.http.put(s,o,{headers:n})}deleteUsuario(o){const s=`${this.baseUrl}/usuarios/`,n={headers:(new d.WM).set("x-token",this.authService.token).set("content-type","application/json"),body:{uid:o}};return this.http.delete(s,n)}}return r.\u0275fac=function(o){return new(o||r)(t.LFG(d.eN),t.LFG(T.e))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=a(7423),m=a(9224),h=a(7322),_=a(7531),x=a(4107),A=a(508);function k(r,e){if(1&r&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&r){const o=e.$implicit;t.Q6J("value",o.uid),t.xp6(1),t.hij(" ",o.nombre," ")}}let v=(()=>{class r{constructor(o,s,n,l){this.data=o,this.dialogRef=s,this.fb=n,this.usuarioService=l,this.roles=this.data.roles,this.usuario=this.data.usuario||{},this.formUsuario=this.fb.group({nombre:["",[i.kI.required,i.kI.minLength(3),i.kI.maxLength(30)]],paterno:["",[i.kI.required,i.kI.minLength(3),i.kI.maxLength(30)]],materno:["",[i.kI.required,i.kI.minLength(3),i.kI.maxLength(30)]],correo:["",[i.kI.required,i.kI.email]],rol:["",[i.kI.required]],password:["123456",[i.kI.required,i.kI.minLength(6)]]})}ngOnInit(){this.cargarFormulario()}cargarFormulario(){this.usuario.uid&&(this.formUsuario.controls.nombre.setValue(this.usuario.nombre),this.formUsuario.controls.paterno.setValue(this.usuario.paterno),this.formUsuario.controls.materno.setValue(this.usuario.materno),this.formUsuario.controls.correo.setValue(this.usuario.correo),this.formUsuario.controls.rol.setValue(this.usuario.rol._id))}guardarUsuario(){this.formUsuario.invalid?this.formUsuario.markAllAsTouched():(this.usuario.nombre=this.formUsuario.controls.nombre.value.trim().toUpperCase(),this.usuario.paterno=this.formUsuario.controls.paterno.value.trim().toUpperCase(),this.usuario.materno=this.formUsuario.controls.materno.value.trim().toUpperCase(),this.usuario.correo=this.formUsuario.controls.correo.value.trim().toLowerCase(),this.usuario.rol=this.formUsuario.controls.rol.value,this.usuario.password=this.formUsuario.controls.password.value,void 0!==this.usuario.uid?this.usuarioService.putUsuario(this.usuario).subscribe(o=>{this.dialogRef.close(!0===o.ok)}):this.usuarioService.postUsuario(this.usuario).subscribe(o=>{this.dialogRef.close(!0===o.ok)}))}}return r.\u0275fac=function(o){return new(o||r)(t.Y36(c.WI),t.Y36(c.so),t.Y36(i.qu),t.Y36(b))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-usuarios-modal"]],decls:44,vars:2,consts:[["autocomplete","off",3,"formGroup","ngSubmit"],["appearance","fill"],["matInput","","formControlName","nombre"],["matInput","","formControlName","paterno"],["matInput","","formControlName","materno"],["matInput","","formControlName","correo"],["formControlName","rol"],[3,"value",4,"ngFor","ngForOf"],["mat-button","","mat-dialog-close",""],["mat-raised-button","","color","primary","type","submit"],[3,"value"]],template:function(o,s){1&o&&(t.TgZ(0,"mat-card")(1,"form",0),t.NdJ("ngSubmit",function(){return s.guardarUsuario()}),t.TgZ(2,"mat-card-header")(3,"mat-card-title"),t._uU(4,"Usuario"),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6,"Nuevo"),t.qZA()(),t.TgZ(7,"mat-card-content")(8,"mat-form-field",1)(9,"mat-label"),t._uU(10,"Nombre"),t.qZA(),t._UZ(11,"input",2),t.TgZ(12,"mat-error"),t._uU(13," Revise el Nombre "),t.qZA()(),t.TgZ(14,"mat-form-field",1)(15,"mat-label"),t._uU(16,"Apellido Paterno"),t.qZA(),t._UZ(17,"input",3),t.TgZ(18,"mat-error"),t._uU(19," Revise el Apellido "),t.qZA()(),t.TgZ(20,"mat-form-field",1)(21,"mat-label"),t._uU(22,"Apellido Materno"),t.qZA(),t._UZ(23,"input",4),t.TgZ(24,"mat-error"),t._uU(25," Revise el Apellido "),t.qZA()(),t.TgZ(26,"mat-form-field",1)(27,"mat-label"),t._uU(28,"Correo"),t.qZA(),t._UZ(29,"input",5),t.TgZ(30,"mat-error"),t._uU(31," Revise el Correo "),t.qZA()(),t.TgZ(32,"mat-form-field",1)(33,"mat-label"),t._uU(34,"Rol de Usuario"),t.qZA(),t.TgZ(35,"mat-select",6),t.YNc(36,k,2,2,"mat-option",7),t.qZA(),t.TgZ(37,"mat-error"),t._uU(38," Revise el Rol de Usuario "),t.qZA()()(),t.TgZ(39,"mat-card-actions")(40,"button",8),t._uU(41,"Cancelar"),t.qZA(),t.TgZ(42,"button",9),t._uU(43,"Guardar"),t.qZA()()()()),2&o&&(t.xp6(1),t.Q6J("formGroup",s.formUsuario),t.xp6(35),t.Q6J("ngForOf",s.roles))},dependencies:[p.sg,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,Z.lW,m.a8,m.dk,m.dn,m.n5,m.$j,m.hq,c.ZT,h.TO,h.KE,h.hX,_.Nt,x.gD,A.ey],styles:["mat-form-field[_ngcontent-%COMP%]{display:block;margin-top:10px}"]}),r})();var S=a(4545),R=a(5626),N=a(7261),y=a(5245),u=a(4999);function I(r,e){1&r&&(t.TgZ(0,"th",13),t._uU(1," NOMBRE "),t.qZA())}function M(r,e){if(1&r&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&r){const o=e.$implicit;t.xp6(1),t.lnq("",o.nombre," ",o.paterno," ",o.materno,"")}}function Y(r,e){1&r&&(t.TgZ(0,"th",13),t._uU(1," CORREO "),t.qZA())}function B(r,e){if(1&r&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&r){const o=e.$implicit;t.xp6(1),t.hij(" ",o.correo," ")}}function L(r,e){1&r&&(t.TgZ(0,"th",13),t._uU(1," ROL DE USUARIO "),t.qZA())}function q(r,e){if(1&r&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&r){const o=e.$implicit;t.xp6(1),t.hij(" ",o.rol.nombre," ")}}function F(r,e){1&r&&(t.TgZ(0,"th",13),t._uU(1," OPCIONES "),t.qZA())}function J(r,e){if(1&r){const o=t.EpF();t.TgZ(0,"td",14)(1,"button",15),t.NdJ("click",function(){const l=t.CHM(o).$implicit,f=t.oxw(2);return t.KtG(f.editar(l.uid))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",15),t.NdJ("click",function(){const l=t.CHM(o).$implicit,f=t.oxw(2);return t.KtG(f.eliminar(l.uid))}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function O(r,e){1&r&&t._UZ(0,"tr",16)}function D(r,e){1&r&&t._UZ(0,"tr",17)}function w(r,e){if(1&r&&(t.TgZ(0,"table",4),t.ynx(1,5),t.YNc(2,I,2,0,"th",6),t.YNc(3,M,2,3,"td",7),t.BQk(),t.ynx(4,8),t.YNc(5,Y,2,0,"th",6),t.YNc(6,B,2,1,"td",7),t.BQk(),t.ynx(7,9),t.YNc(8,L,2,0,"th",6),t.YNc(9,q,2,1,"td",7),t.BQk(),t.ynx(10,10),t.YNc(11,F,2,0,"th",6),t.YNc(12,J,7,0,"td",7),t.BQk(),t.YNc(13,O,1,0,"tr",11),t.YNc(14,D,1,0,"tr",12),t.qZA()),2&r){const o=t.oxw();t.Q6J("dataSource",o.usuariosList),t.xp6(13),t.Q6J("matHeaderRowDef",o.displayHeader),t.xp6(1),t.Q6J("matRowDefColumns",o.displayHeader)}}const E=[{path:"",children:[{path:"",component:(()=>{class r{constructor(o,s,n,l){this.usuarioService=o,this.parametrosService=s,this._snackBar=n,this.dialog=l,this.displayHeader=["nombre","correo","rol","opcion"]}ngOnInit(){this.getUsuarios(),this.getRoles()}getRoles(){this.parametrosService.getRoles().subscribe(o=>{this.rolesList=!0===o.ok?o.data:[]})}getUsuarios(){this.usuarioService.getUsuarios().subscribe(o=>{this.usuariosList=!0===o.ok?o.data:[]})}abrirModal(){this.dialog.open(v,{width:"500px",disableClose:!0,data:{roles:this.rolesList}}).afterClosed().subscribe(o=>{!0===o?(this.getUsuarios(),this.abrirSnackBar("Registro Exitoso")):this.abrirSnackBar("Error al Registrar")})}editar(o){this.usuarioService.getUsuarios(o).subscribe(s=>{!0===s.ok&&this.dialog.open(v,{width:"500px",disableClose:!0,data:{roles:this.rolesList,usuario:s.data}}).afterClosed().subscribe(n=>{!0===n?(this.getUsuarios(),this.abrirSnackBar("Modificaci\xf3n Exitosa")):this.abrirSnackBar("Error al Modificar")})})}eliminar(o){this.dialog.open(S.m,{width:"250px",disableClose:!0,data:{titulo:"Borrar Usuario"}}).afterClosed().subscribe(n=>{!0===n&&this.usuarioService.deleteUsuario(o).subscribe(l=>{!0===l.ok&&(this.getUsuarios(),this.abrirSnackBar("Eliminaci\xf3n Exitosa"))})})}abrirSnackBar(o){this._snackBar.open(o.toString(),"Aceptar",{horizontalPosition:"end",verticalPosition:"top",duration:1500})}}return r.\u0275fac=function(o){return new(o||r)(t.Y36(b),t.Y36(R.u),t.Y36(N.ux),t.Y36(c.uw))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-usuarios"]],decls:11,vars:1,consts:[[1,"row"],[1,"titulo"],["mat-raised-button","","color","primary",1,"titulo",3,"click"],["mat-table","","class","mat-elevation-z8",3,"dataSource",4,"ngIf"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","nombre"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","correo"],["matColumnDef","rol"],["matColumnDef","opcion"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","accent",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,s){1&o&&(t.TgZ(0,"div",0)(1,"h1")(2,"mat-icon",1),t._uU(3,"persons"),t.qZA(),t.TgZ(4,"span"),t._uU(5," Usuarios "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){return s.abrirModal()}),t.TgZ(7,"mat-icon"),t._uU(8,"person_add"),t.qZA(),t._uU(9," Agregar Usuario "),t.qZA()()(),t.YNc(10,w,15,3,"table",3)),2&o&&(t.xp6(10),t.Q6J("ngIf",s.usuariosList))},dependencies:[p.O5,Z.lW,y.Hw,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),r})()},{path:"**",redirectTo:""}]}];let Q=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[g.Bz.forChild(E),g.Bz]}),r})();var $=a(898);let j=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[p.ez,Q,i.UX,$.q]}),r})()}}]);